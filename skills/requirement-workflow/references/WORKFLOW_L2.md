# L2: Standard Workflow / æ ‡å‡†æµç¨‹

å¸¸è§„åŠŸèƒ½å¼€å‘çš„å®Œæ•´å·¥ä½œæµã€‚

## Overview / æ¦‚è§ˆ

```
INIT â†’ ANALYZING â†’ PLANNING â†’ DESIGNING â†’ IMPLEMENTING â†’ TESTING â†’ DELIVERING â†’ DONE
```

| å±æ€§ | å€¼ |
|------|-----|
| ç›®æ ‡æ—¶é—´ | 1-8 å°æ—¶ |
| äº§å‡ºç‰© | spec.md, design.md, tasks.md, checklist.md, report.md |
| é€‚ç”¨ | æ–°åŠŸèƒ½å¼€å‘, API å˜æ›´, ç»„ä»¶é‡æ„ |

## Stages / é˜¶æ®µè¯¦æƒ…

### Stage 1: INIT â†’ ANALYZING

**è§¦å‘:** å·¥ä½œæµåˆå§‹åŒ–å®Œæˆå

**AI æ‰§è¡Œ:**
1. ç†è§£ç”¨æˆ·éœ€æ±‚
2. æå‡ºæ¾„æ¸…é—®é¢˜ï¼ˆå¦‚éœ€è¦ï¼‰
3. è®°å½•éœ€æ±‚åˆ° `spec.md`

**äº§å‡º (spec.md):**
```markdown
# éœ€æ±‚è§„æ ¼: {name}

## èƒŒæ™¯
{ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåŠŸèƒ½}

## ç›®æ ‡
{åŠŸèƒ½è¦è¾¾æˆä»€ä¹ˆ}

## èŒƒå›´
- åŒ…å«: {åŠŸèƒ½è¾¹ç•Œå†…}
- ä¸åŒ…å«: {æ˜ç¡®æ’é™¤çš„}

## éªŒæ”¶æ ‡å‡†
- [ ] {æ ‡å‡†1}
- [ ] {æ ‡å‡†2}
```

**çŠ¶æ€è½¬æ¢:**
```bash
./scripts/advance-stage.sh -r /project --to ANALYZING
```

### Stage 2: ANALYZING â†’ PLANNING

**è§¦å‘:** éœ€æ±‚æ˜ç¡®ï¼Œspec.md å®Œæˆ

**AI æ‰§è¡Œ:**
1. åˆ†æç°æœ‰ä»£ç åº“
2. è¯†åˆ«å—å½±å“çš„æ¨¡å—
3. è§„åˆ’æŠ€æœ¯æ–¹æ¡ˆ
4. åˆ›å»ºä»»åŠ¡åˆ—è¡¨ (`tasks.md`)

**äº§å‡º (tasks.md):**
```markdown
# ä»»åŠ¡åˆ—è¡¨

## Phase 1: å‡†å¤‡å·¥ä½œ
- [ ] ä»»åŠ¡1.1
- [ ] ä»»åŠ¡1.2

## Phase 2: æ ¸å¿ƒå®ç°
- [ ] ä»»åŠ¡2.1
- [ ] ä»»åŠ¡2.2

## Phase 3: æµ‹è¯•ä¸å®Œå–„
- [ ] ä»»åŠ¡3.1
```

**çŠ¶æ€è½¬æ¢:**
```bash
./scripts/advance-stage.sh -r /project --to PLANNING
```

### Stage 3: PLANNING â†’ DESIGNING

**è§¦å‘:** ä»»åŠ¡è§„åˆ’å®Œæˆ

**AI æ‰§è¡Œ:**
1. è®¾è®¡æŠ€æœ¯æ–¹æ¡ˆ
2. ç¡®å®š API æ¥å£ï¼ˆå¦‚é€‚ç”¨ï¼‰
3. è®¾è®¡æ•°æ®ç»“æ„
4. è®°å½•åˆ° `design.md`

**äº§å‡º (design.md):**
```markdown
# æŠ€æœ¯è®¾è®¡: {name}

## æ–¹æ¡ˆæ¦‚è¿°
{æ•´ä½“è®¾è®¡æ€è·¯}

## ç»„ä»¶äº¤äº’
{æ¨¡å—é—´å¦‚ä½•é…åˆ}

## API è®¾è®¡ (å¦‚é€‚ç”¨)
| æ¥å£ | æ–¹æ³• | æè¿° |
|------|------|------|
| /api/xxx | POST | ... |

## æ•°æ®æ¨¡å‹
{æ•°æ®ç»“æ„å®šä¹‰}

## é£é™©ä¸ç¼“è§£
| é£é™© | ç¼“è§£æªæ–½ |
|------|----------|
```

**çŠ¶æ€è½¬æ¢:**
```bash
./scripts/advance-stage.sh -r /project --to DESIGNING
```

### Stage 4: DESIGNING â†’ IMPLEMENTING

**è§¦å‘:** è®¾è®¡å®Œæˆï¼Œdesign.md å®Œæˆ

**AI æ‰§è¡Œ:**
1. æŒ‰ tasks.md é¡ºåºæ‰§è¡Œ
2. ä½¿ç”¨ TodoWrite è·Ÿè¸ª
3. æ¯å®Œæˆä»»åŠ¡æ›´æ–°è¿›åº¦

**æ‰§è¡Œè§„èŒƒ:**
- éµå¾ªç°æœ‰ä»£ç é£æ ¼
- æ·»åŠ å¿…è¦çš„æµ‹è¯•
- åŠæ—¶æäº¤è¿›åº¦

**çŠ¶æ€è½¬æ¢:**
```bash
./scripts/advance-stage.sh -r /project --to IMPLEMENTING
```

### Stage 5: IMPLEMENTING â†’ TESTING

**è§¦å‘:** æ‰€æœ‰å¼€å‘ä»»åŠ¡å®Œæˆ

**AI æ‰§è¡Œ:**
1. è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
2. æ‰§è¡Œè´¨é‡æ£€æŸ¥:
   - Lint check
   - Type check
   - Unit tests
   - Integration tests (å¦‚é€‚ç”¨)
3. æ›´æ–° `checklist.md`

**äº§å‡º (checklist.md):**
```markdown
# éªŒæ”¶æ¸…å•

## åŠŸèƒ½éªŒè¯
- [ ] æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸
- [ ] è¾¹ç•Œæ¡ä»¶å¤„ç†
- [ ] é”™è¯¯å¤„ç†

## è´¨é‡æ£€æŸ¥
- [ ] Lint é€šè¿‡
- [ ] Type check é€šè¿‡
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æµ‹è¯•è¦†ç›–ç‡ >= 70%

## æ–‡æ¡£
- [ ] API æ–‡æ¡£æ›´æ–°
- [ ] README æ›´æ–°ï¼ˆå¦‚éœ€è¦ï¼‰
```

**Hook Point:** `quality_gate`

**çŠ¶æ€è½¬æ¢:**
```bash
./scripts/advance-stage.sh -r /project --to TESTING
```

### Stage 6: TESTING â†’ DELIVERING

**è§¦å‘:** æ‰€æœ‰æµ‹è¯•é€šè¿‡

**AI æ‰§è¡Œ:**
1. ç”Ÿæˆå˜æ›´æŠ¥å‘Š
2. å‡†å¤‡äº¤ä»˜ææ–™
3. æ›´æ–° `artifacts/report.md`

**äº§å‡º (report.md):**
```markdown
# å·¥ä½œæµæŠ¥å‘Š

## æ¦‚è¦
| é¡¹ç›® | å€¼ |
|------|-----|
| å·¥ä½œæµ ID | xxx |
| ç±»å‹ | feature |
| çº§åˆ« | L2 |
| ç”¨æ—¶ | 4h 30m |

## å˜æ›´æ‘˜è¦
- æ–°å¢æ–‡ä»¶: 3
- ä¿®æ”¹æ–‡ä»¶: 5
- åˆ é™¤æ–‡ä»¶: 0

## æµ‹è¯•ç»“æœ
- å•å…ƒæµ‹è¯•: é€šè¿‡
- è¦†ç›–ç‡: 78%

## å¤‡æ³¨
{å…¶ä»–è¯´æ˜}
```

**çŠ¶æ€è½¬æ¢:**
```bash
./scripts/advance-stage.sh -r /project --to DELIVERING
```

### Stage 7: DELIVERING â†’ DONE

**è§¦å‘:** äº¤ä»˜ææ–™å‡†å¤‡å®Œæˆ

**AI æ‰§è¡Œ:**
1. æœ€ç»ˆç¡®è®¤æ‰€æœ‰ä»»åŠ¡å®Œæˆ
2. æ€»ç»“å·¥ä½œæµ
3. æ ‡è®°å®Œæˆ

**çŠ¶æ€è½¬æ¢:**
```bash
./scripts/advance-stage.sh -r /project --to DONE
```

## Complete Example / å®Œæ•´ç¤ºä¾‹

### åœºæ™¯: å®ç°ç”¨æˆ·å¤´åƒä¸Šä¼ åŠŸèƒ½

```
User: æˆ‘éœ€è¦å®ç°ä¸€ä¸ªç”¨æˆ·å¤´åƒä¸Šä¼ åŠŸèƒ½

AI: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†åŠŸèƒ½å¼€å‘ï¼Œæˆ‘ä½¿ç”¨ L2 æ ‡å‡†æµç¨‹ã€‚

ğŸ“Š éœ€æ±‚åˆ†æ:
- ç±»å‹: feature
- çº§åˆ«: L2 (Standard)
- é¢„ä¼°å½±å“: ~10 ä¸ªæ–‡ä»¶

æ­£åœ¨åˆå§‹åŒ–å·¥ä½œæµ...

âœ… Workflow: 20240115_001_feature_user-avatar-upload
ğŸ“ .trae/workflow/20240115_001_feature_user-avatar-upload/

---

[ANALYZING] éœ€æ±‚åˆ†æ

éœ€è¦æ¾„æ¸…å‡ ä¸ªé—®é¢˜:
1. å¤´åƒå°ºå¯¸é™åˆ¶æ˜¯å¤šå°‘?
2. æ”¯æŒå“ªäº›å›¾ç‰‡æ ¼å¼?
3. æ˜¯å¦éœ€è¦è£å‰ªåŠŸèƒ½?

User: é™åˆ¶ 2MBï¼Œæ”¯æŒ jpg/pngï¼Œéœ€è¦åœ†å½¢è£å‰ª

AI: æ˜ç™½äº†ï¼Œæˆ‘æ¥æ›´æ–°éœ€æ±‚è§„æ ¼...

ğŸ“„ spec.md å·²åˆ›å»º:
- æœ€å¤§æ–‡ä»¶: 2MB
- æ ¼å¼: jpg, png
- è£å‰ª: åœ†å½¢é¢„è§ˆ
- å­˜å‚¨: å¯¹è±¡å­˜å‚¨æœåŠ¡

æ¨è¿›åˆ° PLANNING...

---

[PLANNING] ä»»åŠ¡è§„åˆ’

åˆ†æç°æœ‰ä»£ç ç»“æ„åï¼Œè§„åˆ’ä»»åŠ¡:

ğŸ“‹ tasks.md:
1. åˆ›å»ºä¸Šä¼ ç»„ä»¶ AvatarUploader
2. æ·»åŠ å›¾ç‰‡è£å‰ªåŠŸèƒ½
3. å®ç°åç«¯ä¸Šä¼  API
4. é›†æˆå­˜å‚¨æœåŠ¡
5. æ›´æ–°ç”¨æˆ· Profile é¡µé¢
6. æ·»åŠ å•å…ƒæµ‹è¯•

æ¨è¿›åˆ° DESIGNING...

---

[DESIGNING] æŠ€æœ¯è®¾è®¡

ğŸ“„ design.md å·²åˆ›å»º:

ç»„ä»¶è®¾è®¡:
- AvatarUploader: å¤„ç†æ–‡ä»¶é€‰æ‹©å’Œé¢„è§ˆ
- ImageCropper: åœ†å½¢è£å‰ªåŠŸèƒ½

API è®¾è®¡:
- POST /api/users/avatar
- è¿”å›: { url: string }

å­˜å‚¨æ–¹æ¡ˆ:
- ä½¿ç”¨ S3 å…¼å®¹å­˜å‚¨
- è·¯å¾„: /avatars/{userId}/{timestamp}.{ext}

æ¨è¿›åˆ° IMPLEMENTING...

---

[IMPLEMENTING] ç¼–ç å®ç°

å¼€å§‹æ‰§è¡Œä»»åŠ¡åˆ—è¡¨...

âœ… ä»»åŠ¡ 1: AvatarUploader ç»„ä»¶å®Œæˆ
âœ… ä»»åŠ¡ 2: ImageCropper ç»„ä»¶å®Œæˆ
âœ… ä»»åŠ¡ 3: ä¸Šä¼  API å®Œæˆ
âœ… ä»»åŠ¡ 4: å­˜å‚¨æœåŠ¡é›†æˆå®Œæˆ
âœ… ä»»åŠ¡ 5: Profile é¡µé¢æ›´æ–°å®Œæˆ
âœ… ä»»åŠ¡ 6: å•å…ƒæµ‹è¯•å®Œæˆ

æ¨è¿›åˆ° TESTING...

---

[TESTING] æµ‹è¯•éªŒè¯

æ‰§è¡Œè´¨é‡æ£€æŸ¥:
- âœ… TypeScript ç¼–è¯‘é€šè¿‡
- âœ… ESLint æ— é”™è¯¯
- âœ… å•å…ƒæµ‹è¯•é€šè¿‡ (12/12)
- âœ… è¦†ç›–ç‡: 75%

æ›´æ–° checklist.md...

æ¨è¿›åˆ° DELIVERING...

---

[DELIVERING] äº¤ä»˜å‡†å¤‡

ç”ŸæˆæŠ¥å‘Š artifacts/report.md:
- æ–°å¢æ–‡ä»¶: 4
- ä¿®æ”¹æ–‡ä»¶: 6
- æ€»ä»£ç è¡Œ: +320, -15
- æµ‹è¯•è¦†ç›–: 75%

æ¨è¿›åˆ° DONE...

---

[DONE] å·¥ä½œæµå®Œæˆ

âœ… ç”¨æˆ·å¤´åƒä¸Šä¼ åŠŸèƒ½å·²å®Œæˆï¼

å˜æ›´æ‘˜è¦:
- å‰ç«¯: AvatarUploader, ImageCropper ç»„ä»¶
- åç«¯: /api/users/avatar æ¥å£
- å­˜å‚¨: S3 é›†æˆ

æ€»ç”¨æ—¶: 3h 45m
```

## Quality Gate / è´¨é‡é—¨ç¦

L2 çš„æ ‡å‡†è´¨é‡æ£€æŸ¥:

```yaml
quality_gate:
  lint: required
  type_check: required
  unit_tests: required
  coverage_threshold: 70%
  integration_tests: recommended
```

## Hooks / å¯ç”¨é’©å­

```
pre_stage_{STAGE}      # è¿›å…¥é˜¶æ®µå‰
post_stage_{STAGE}     # å®Œæˆé˜¶æ®µå
pre_task_{task_id}     # æ‰§è¡Œä»»åŠ¡å‰
post_task_{task_id}    # å®Œæˆä»»åŠ¡å
quality_gate           # è´¨é‡æ£€æŸ¥æ—¶
pre_delivery           # äº¤ä»˜å‰
on_blocked             # é˜»å¡æ—¶
on_error               # å‡ºé”™æ—¶
```

## Skill Injection / æŠ€èƒ½æ³¨å…¥

L2 æ¨èæ³¨å…¥çš„æŠ€èƒ½:

```yaml
injected_skills:
  - stage: DESIGNING
    skill: code-reviewer
    timing: post
    
  - stage: IMPLEMENTING  
    skill: test-generator
    timing: during
    
  - stage: TESTING
    skill: coverage-checker
    timing: pre
```

## Escalation / å‡çº§åˆ° L3

å¦‚æœå‘ç°:
- æ¶‰åŠå®‰å…¨æ•æ„Ÿæ“ä½œ
- éœ€è¦è·¨å›¢é˜Ÿå®¡æ‰¹
- å¤æ‚åº¦è¶…å‡ºé¢„æœŸ

**åº”å‡çº§åˆ° L3ã€‚**
